import{a as G,A as y}from"./index.mT9_goUm.js";import{u as p}from"./useGlobalFilters.BuA1oYH7.js";import{w as I,e as g,r as d}from"./vendor.iNPlSTaR.js";async function A(a){const e={};a&&(a.segmento&&(e.segmento=a.segmento),a.diretoria&&(e.diretoria=a.diretoria),a.regional&&(e.regional=a.regional),a.agencia&&(e.agencia=a.agencia),a.gerente&&(e.gerente=a.gerente),a.gerenteGestao&&(e.gerenteGestao=a.gerenteGestao),a.familia&&(e.familia=a.familia),a.indicador&&(e.indicador=a.indicador),a.subindicador&&(e.subindicador=a.subindicador),a.dataInicio&&(e.dataInicio=a.dataInicio),a.dataFim&&(e.dataFim=a.dataFim));const n=await G(y.DETALHES,e);return n.success&&n.data?n.data:(console.error("Erro ao buscar detalhes:",n.error),null)}const t=d(null),s=d(!1),r=d(null),u=d(null);let w=!1;function i(a){if(!a)return;const e=a.trim();if(!e)return;const n=e.toLowerCase();if(!(n==="todos"||n==="todas"))return e}function f(a,e){const n={};if(a){const c=i(a.segmento),o=i(a.diretoria),l=i(a.gerencia),m=i(a.agencia),v=i(a.gerente),h=i(a.ggestao),b=i(a.familia),D=i(a.indicador),F=i(a.subindicador);c&&(n.segmento=c),o&&(n.diretoria=o),l&&(n.regional=l),m&&(n.agencia=m),v&&(n.gerente=v),h&&(n.gerenteGestao=h),b&&(n.familia=b),D&&(n.indicador=D),F&&(n.subindicador=F)}return e?.start&&(n.dataInicio=e.start),e?.end&&(n.dataFim=e.end),n}async function E(a){if(!s.value){u.value=a,s.value=!0,r.value=null;try{const e=await A(a);e?t.value=e:(r.value="Não foi possível carregar os dados de detalhes",t.value=[])}catch(e){console.error("Erro ao carregar detalhes:",e),r.value=e instanceof Error?e.message:"Erro desconhecido"}finally{s.value=!1}}}function x(){t.value=null,r.value=null,u.value=null}function z(a,e){if(!w){w=!0;const{filterTrigger:o}=p();I(o,()=>{const l=f(a.value,e.value);E(l)},{immediate:!0})}const n=async()=>{const o=u.value??f(a.value,e.value);await E(o)},c=()=>{t.value=null,r.value=null,u.value=null};return{detalhes:g(()=>t.value??[]),loading:g(()=>s.value),error:g(()=>r.value),loadDetalhes:n,clearData:c,buildFilters:()=>f(a.value,e.value)}}export{x as c,z as u};
