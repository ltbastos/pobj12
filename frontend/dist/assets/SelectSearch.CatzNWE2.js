import{b as q,r as y,e as I,w as L,m as i,k as m,q as d,j as x,B as h,E as p,F as K,D as O,t as N,v as u,G as B,H as T,y as _,A as M,o as r}from"./vendor.Mb-DmQZ9.js";import{I as P,_ as R}from"./index.BTfDv-kk.js";const U=["id","value","disabled"],z={key:0,value:""},F=["value"],j=["aria-expanded","aria-controls","aria-label"],G=["aria-label"],H=["id","aria-label"],J={class:"select-search__box"},Q=["for"],W=["id","placeholder","aria-label","onKeydown"],X=["aria-label"],Y={key:0,class:"select-search__empty",role:"status","aria-live":"polite"},Z=["aria-selected","tabindex","onClick","onKeydown"],ee=q({__name:"SelectSearch",props:{modelValue:{},options:{},placeholder:{default:"Selecione..."},label:{default:""},disabled:{type:Boolean,default:!1},id:{default:""}},emits:["update:modelValue"],setup(t,{emit:E}){const o=t,k=E,s=y(!1),n=y(""),c=y(null),w=y(null),g=e=>e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim():"",v=I(()=>{if(!n.value)return o.options.slice(0,10);const e=g(n.value);return o.options.filter(l=>g(l.nome).includes(e)).slice(0,12)}),V=I(()=>o.modelValue&&o.options.find(l=>l.id===o.modelValue)?.nome||o.placeholder),C=()=>{o.disabled||(s.value=!s.value,s.value&&(n.value="",setTimeout(()=>{w.value?.focus()},0)))},b=e=>{k("update:modelValue",e.id),s.value=!1,n.value=""},$=e=>{if(e.key==="Escape")s.value=!1,n.value="";else if(e.key==="Enter"&&v.value.length>0&&s.value){e.preventDefault();const l=v.value[0];l&&b(l)}else["ArrowDown","ArrowUp"," "].includes(e.key)&&!s.value?(e.preventDefault(),s.value=!0,setTimeout(()=>{w.value?.focus()},0)):e.key==="ArrowDown"&&s.value?(e.preventDefault(),D()):e.key==="ArrowUp"&&s.value&&(e.preventDefault(),S())},D=()=>{const e=c.value?.querySelectorAll(".select-search__item");if(!e||e.length===0)return;const l=Array.from(e).findIndex(f=>f===document.activeElement),a=l<e.length-1?l+1:0;e[a]?.focus()},S=()=>{const e=c.value?.querySelectorAll(".select-search__item");if(!e||e.length===0)return;const l=Array.from(e).findIndex(f=>f===document.activeElement),a=l>0?l-1:e.length-1;e[a]?.focus()};return(e=>{const l=a=>{c.value&&!c.value.contains(a.target)&&e()};_(()=>{document.addEventListener("click",l)}),M(()=>{document.removeEventListener("click",l)})})(()=>{s.value=!1,n.value=""}),L(()=>o.disabled,e=>{e&&(s.value=!1)}),(e,l)=>(r(),i("div",{ref_key:"wrapperRef",ref:c,class:m(["select-search",{"is-open":s.value}])},[d("select",{id:t.id,value:t.modelValue,onChange:l[0]||(l[0]=a=>k("update:modelValue",a.target.value)),onMousedown:h(C,["prevent"]),onKeydown:$,class:"input",disabled:t.disabled,"data-search":!0,style:{display:"none"}},[t.modelValue?x("",!0):(r(),i("option",z,p(t.placeholder),1)),(r(!0),i(K,null,O(t.options,a=>(r(),i("option",{key:a.id,value:a.id},p(a.nome),9,F))),128))],40,U),d("div",{class:m(["select-search__trigger",{"is-disabled":t.disabled}]),onClick:C,onKeydown:$,tabindex:"0",role:"combobox","aria-expanded":s.value,"aria-haspopup":"listbox","aria-controls":`${t.id}-listbox`,"aria-label":t.label||"Selecione uma opção"},[d("span",{class:m({"is-placeholder":!t.modelValue}),"aria-label":t.modelValue?V.value:t.placeholder},p(V.value),11,G),N(P,{name:"chevron-down",size:16,class:m([{"is-open":s.value},"icon"])},null,8,["class"])],42,j),s.value?(r(),i("div",{key:0,id:`${t.id}-listbox`,class:"select-search__panel",role:"listbox","aria-label":t.label||"Opções",onKeydown:l[3]||(l[3]=u(a=>s.value=!1,["escape"]))},[d("div",J,[d("label",{for:`${t.id}-search`,class:"sr-only"},"Pesquisar "+p(t.label||"opção"),9,Q),B(d("input",{id:`${t.id}-search`,ref_key:"inputRef",ref:w,"onUpdate:modelValue":l[1]||(l[1]=a=>n.value=a),type:"search",class:"input input--xs select-search__input",placeholder:`Pesquisar ${t.label?.toLowerCase()||"opção"}`,"aria-label":`Pesquisar ${t.label||"opção"}`,autocomplete:"off",onKeydown:[l[2]||(l[2]=u(a=>s.value=!1,["escape"])),u(h(D,["prevent"]),["arrow-down"]),u(h(S,["prevent"]),["arrow-up"])]},null,40,W),[[T,n.value]])]),d("div",{class:"select-search__results",role:"group","aria-label":`${v.value.length} opções disponíveis`},[v.value.length===0?(r(),i("div",Y," Nenhum resultado encontrado ")):x("",!0),(r(!0),i(K,null,O(v.value,(a,f)=>(r(),i("button",{key:a.id,type:"button",class:m(["select-search__item",{"is-selected":a.id===t.modelValue}]),role:"option","aria-selected":a.id===t.modelValue,tabindex:f===0?0:-1,onClick:A=>b(a),onKeydown:[u(h(A=>b(a),["prevent"]),["enter"]),u(h(A=>b(a),["prevent"]),["space"])]},p(a.nome),43,Z))),128))],8,X)],40,H)):x("",!0)],2))}}),se=R(ee,[["__scopeId","data-v-1eb003a8"]]);export{se as S};
