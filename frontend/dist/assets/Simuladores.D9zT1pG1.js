import{b as ia,r as x,y as la,e as M,w as oa,m as n,q as t,M as na,F as c,B as ra,t as F,k as $,G as da,E as l,H as ua,j as g,C as u,u as m,D as ca,o as r}from"./vendor.Mb-DmQZ9.js";import{a as ma,A as va,I as j,_ as ha}from"./index.BTfDv-kk.js";import{e as p,f as D,a as P}from"./formatUtils.SsKD9Isb.js";import{S as _a}from"./SelectInput.BhwZv7qT.js";import"./pdf-vendor.BFzd3waL.js";import"./icons-vendor.vP8HAgRq.js";import"./vue-router.BEbJbLaE.js";async function pa(O){const f={},d=await ma(va.SIMULADOR,f);return d.success&&d.data?d.data:(console.error("Erro ao buscar produtos para simulador:",d.error),null)}const fa={class:"simuladores-wrapper"},wa={class:"simuladores-view"},ga={class:"card card--simuladores"},ka={id:"sim-whatif",class:"sim-whatif"},Ma={key:0,class:"sim-whatif__skeleton"},ya={class:"sim-whatif__field"},ba={class:"sim-whatif__field"},xa={id:"sim-whatif-prefix",class:"sim-whatif__prefix"},Da=["placeholder","disabled"],Pa={class:"sim-whatif__hint-group"},Ra={id:"sim-whatif-unit",class:"sim-whatif__hint"},Ia={class:"sim-whatif__hint-item"},Aa={class:"sim-whatif__hint-item"},Fa={key:0,class:"sim-whatif__hint-item sim-whatif__hint-item--gap"},za={key:0,class:"sim-whatif__hint sim-whatif__hint--delta"},Sa={key:0,class:"sim-quick__label"},ja={key:1,class:"sim-quick__chips"},Ba=["title","onClick"],Na={class:"sim-whatif__results"},Ca={class:"sim-whatif__header"},Ea={id:"sim-whatif-title"},Va={id:"sim-whatif-subtitle",class:"muted"},La={key:0,class:"sim-whatif__empty"},Ua={key:1,id:"sim-whatif-cards",class:"sim-whatif-cards"},qa={class:"sim-whatif-card sim-whatif-card--var"},$a={class:"sim-whatif-card__head"},Oa={class:"sim-whatif-card__icon"},Ta={class:"sim-whatif-card__stats"},Ga={class:"sim-whatif-card__highlight"},Ha={class:"sim-whatif-card__meta"},Ja={class:"sim-whatif-card sim-whatif-card--points"},Ka={class:"sim-whatif-card__head"},Qa={class:"sim-whatif-card__icon"},Wa={class:"sim-whatif-card__stats"},Xa={class:"sim-whatif-card__highlight"},Ya={class:"sim-whatif-card__meta"},Za={class:"sim-whatif-card sim-whatif-card--hit"},at={class:"sim-whatif-card__head"},tt={class:"sim-whatif-card__icon"},et={class:"sim-whatif-card__stats"},st={class:"sim-whatif-card__highlight"},it={class:"sim-whatif-card__meta"},lt={key:2,id:"sim-whatif-foot",class:"sim-whatif__foot"},ot=ia({__name:"Simuladores",setup(O){const f=x(""),d=x(0),y=x(!1),b=x(null),h=x([]),T=async()=>{y.value=!0,b.value=null;try{const e=await pa();e?(h.value=e,h.value.length>0&&!f.value&&(f.value=h.value[0]?.id||"")):(b.value="Erro ao carregar produtos",h.value=[])}catch(e){b.value=e instanceof Error?e.message:"Erro desconhecido",console.error("Erro ao carregar produtos:",e),h.value=[]}finally{y.value=!1}};la(()=>{T()});const s=M(()=>h.value.find(e=>e.id===f.value)||null);M(()=>{const e=new Map;return h.value.forEach(a=>{const i=a.sectionId||a.sectionLabel||"__";e.has(i)||e.set(i,[]),e.get(i).push(a)}),Array.from(e.entries()).map(([a,i])=>({sectionId:a,sectionLabel:i[0]?.sectionLabel||a,items:i.sort((v,w)=>v.label.localeCompare(w.label,"pt-BR"))}))});const G=M(()=>h.value.map(e=>({id:e.id,nome:`${e.sectionLabel} - ${e.label}`})).sort((e,a)=>e.nome.localeCompare(a.nome,"pt-BR"))),H=e=>{f.value=e},_=e=>{if(e==null||e==="")return 0;const a=typeof e=="string"?parseFloat(e):e;return Number.isFinite(a)?a:0},o=M(()=>{if(!s.value)return null;const e=s.value,a=e.metric||"valor",i=Math.max(0,_(e.meta)),v=Math.max(0,_(e.realizado)),w=Math.max(0,_(e.variavelMeta||0)),I=Math.max(0,_(e.variavelReal||0)),k=Math.max(0,_(e.pontosMeta)),Z=Math.max(0,_(e.pontosBrutos)),z=Math.max(0,Math.min(k||Z,_(e.pontos))),A=Math.max(0,_(d.value)),S=v+A,aa=i>0?(w||I)/i:0,N=i>0?k/i:0,C=I+A*aa,E=w>0?Math.min(w,C):C,ta=Math.max(0,E-I),V=k>0?N*S:z+A*N,L=k>0?Math.max(0,Math.min(k,V)):Math.max(0,V),ea=Math.max(0,L-z),U=i>0?v/i*100:0,q=i>0?S/i*100:0,sa=Math.max(0,q-U);return{metric:a,meta:i,realizado:v,novoReal:S,deltaValue:A,variavelAtual:I,variavelProj:E,variavelDelta:ta,pontosAtual:z,pontosProj:L,pontosDelta:ea,atingAtual:U,atingProj:q,atingDelta:sa,variavelMeta:w,pontosMeta:k}}),R=M(()=>{if(!s.value)return[];const e=s.value,a=Math.max(0,_(e.meta));if(!(a>0))return[];const i=Math.max(0,a-_(e.realizado));return[{label:"+5% da meta",value:a*.05},{label:"+10% da meta",value:a*.1},{label:i>0?"Fechar a meta":"+25% da meta",value:i>0?i:a*.25}]}),J=e=>{const a=D(e);return e>0?`+${a}`:a},K=e=>{const a=P(e,{withUnit:!0});return e>0?`+${a}`:a},Q=e=>{const a=s.value;if(!a)return;const i=a.metric==="valor"?1e3:1,v=Math.max(0,Math.round(e/i)*i);d.value=v},W=()=>{if(d.value>0&&s.value){const e=s.value.metric==="valor"?1e3:1;d.value=Math.round(d.value/e)*e}},X=e=>{e.target.select()};oa(f,()=>{d.value=0});const B=M({get:()=>!d.value||d.value===0?"":new Intl.NumberFormat("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(d.value),set:e=>{let a=e.replace(/[^\d,.]/g,"");if(a.includes(","))a=a.replace(/\./g,"").replace(",","");else if(a.includes(".")){const v=a.split(".");v.length===2&&v[1]?.length&&v[1]?.length<=2?a=a.replace(".",""):a=a.replace(/\./g,"")}const i=a?parseFloat(a):0;d.value=isNaN(i)?0:Math.max(0,Math.round(i))}}),Y=e=>!e||e===0?"0":s.value?.metric==="valor"?D(e):new Intl.NumberFormat("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)+" un";return(e,a)=>(r(),n("div",fa,[t("div",wa,[t("section",ga,[a[22]||(a[22]=t("header",{class:"card__header"},[t("div",{class:"title-subtitle"},[t("h3",null,'Simulador "E se?"'),t("p",{class:"muted"},"Simule o impacto de incrementos em indicadores específicos.")])],-1)),t("div",ka,[y.value?(r(),n("div",Ma,[...a[2]||(a[2]=[na('<div class="sim-whatif__form" data-v-15289626><div class="sim-whatif__field" data-v-15289626><div class="skeleton skeleton--label" data-v-15289626></div><div class="skeleton skeleton--input" data-v-15289626></div></div><div class="sim-whatif__field" data-v-15289626><div class="skeleton skeleton--label" data-v-15289626></div><div class="skeleton skeleton--input" data-v-15289626></div><div class="skeleton skeleton--hint" data-v-15289626></div></div></div><div class="skeleton skeleton--shortcuts" data-v-15289626></div><div class="sim-whatif__results" data-v-15289626><div class="skeleton skeleton--title" data-v-15289626></div><div class="skeleton skeleton--subtitle" data-v-15289626></div><div class="sim-whatif-cards" data-v-15289626><div class="skeleton skeleton--card" data-v-15289626></div><div class="skeleton skeleton--card" data-v-15289626></div><div class="skeleton skeleton--card" data-v-15289626></div></div></div>',3)])])):(r(),n(c,{key:1},[t("form",{id:"sim-whatif-form",class:"sim-whatif__form",onSubmit:a[1]||(a[1]=ra(()=>{},["prevent"]))},[t("div",ya,[a[3]||(a[3]=t("label",{for:"sim-whatif-indicador",class:"muted"},"INDICADOR",-1)),F(_a,{id:"sim-whatif-indicador","model-value":f.value,options:G.value,placeholder:"Selecione um indicador",label:"Indicador",disabled:h.value.length===0||y.value,"onUpdate:modelValue":H},null,8,["model-value","options","disabled"])]),t("div",ba,[a[8]||(a[8]=t("label",{for:"sim-whatif-extra",class:"muted"},"INCREMENTO",-1)),t("div",{class:$(["sim-whatif__input-group",{"has-value":d.value>0}])},[t("span",xa,l(s.value?.metric==="valor"?"R$":"+"),1),da(t("input",{id:"sim-whatif-extra",type:"text","onUpdate:modelValue":a[0]||(a[0]=i=>B.value=i),inputmode:"numeric",class:"input sim-whatif__input",placeholder:s.value?.metric==="valor"?"0,00":"0",disabled:!s.value,onBlur:W,onFocus:X},null,40,Da),[[ua,B.value]])],2),t("div",Pa,[t("p",Ra,[s.value?(r(),n(c,{key:0},[t("span",Ia,[a[4]||(a[4]=t("strong",null,"Meta:",-1)),u(" "+l(m(p)(s.value.metric,s.value.meta)),1)]),t("span",Aa,[a[5]||(a[5]=t("strong",null,"Realizado:",-1)),u(" "+l(m(p)(s.value.metric,s.value.realizado)),1)]),s.value.meta>s.value.realizado?(r(),n("span",Fa,[a[6]||(a[6]=t("strong",null,"Falta:",-1)),u(" "+l(m(p)(s.value.metric,s.value.meta-s.value.realizado)),1)])):g("",!0)],64)):(r(),n(c,{key:1},[u(" Selecione um indicador elegível. ")],64))]),d.value>0&&s.value?(r(),n("p",za,[a[7]||(a[7]=u(" Incremento: ",-1)),t("strong",null,l(Y(d.value)),1)])):g("",!0)])])],32),t("div",{id:"sim-whatif-shortcuts",class:$(["sim-quick",{"is-empty":!s.value||R.value.length===0}])},[s.value&&R.value.length>0?(r(),n("span",Sa,"Atalhos")):g("",!0),s.value&&R.value.length>0?(r(),n("div",ja,[(r(!0),n(c,null,ca(R.value,(i,v)=>(r(),n("button",{key:v,type:"button",class:"sim-chip",title:m(p)(s.value.metric,i.value),onClick:w=>Q(i.value)},l(i.label),9,Ba))),128))])):g("",!0)],2),t("div",Na,[t("div",Ca,[t("h4",Ea,[s.value?(r(),n(c,{key:0},[u(" Impacto em "+l(s.value.label),1)],64)):h.value.length===0?(r(),n(c,{key:1},[u(" Sem indicadores elegíveis ")],64)):(r(),n(c,{key:2},[u(" Escolha um indicador para iniciar ")],64))]),t("p",Va,[s.value?(r(),n(c,{key:0},[u(l(s.value.sectionLabel)+" · Meta de "+l(m(p)(s.value.metric,s.value.meta)),1)],64)):h.value.length===0?(r(),n(c,{key:1},[u(" Nenhum indicador disponível no momento. ")],64)):(r(),n(c,{key:2},[u(" Selecione um indicador e informe um incremento para ver o impacto. ")],64))])]),s.value?(r(),n("div",Ua,[t("article",qa,[t("header",$a,[t("span",Oa,[F(j,{name:"coin",size:24})]),a[9]||(a[9]=t("h5",null,"Remuneração variável",-1))]),t("dl",Ta,[t("div",null,[a[10]||(a[10]=t("dt",null,"Atual",-1)),t("dd",null,l(m(D)(o.value?.variavelAtual||0)),1)]),t("div",null,[a[11]||(a[11]=t("dt",null,"Projeção",-1)),t("dd",null,l(m(D)(o.value?.variavelProj||0)),1)]),t("div",null,[a[12]||(a[12]=t("dt",null,"Incremento",-1)),t("dd",Ga,l(J(o.value?.variavelDelta||0)),1)])]),t("p",Ha," Meta de remuneração: "+l(m(D)(o.value?.variavelMeta||o.value?.variavelProj||0)),1)]),t("article",Ja,[t("header",Ka,[t("span",Qa,[F(j,{name:"medal",size:24})]),a[13]||(a[13]=t("h5",null,"Pontuação",-1))]),t("dl",Wa,[t("div",null,[a[14]||(a[14]=t("dt",null,"Atual",-1)),t("dd",null,l(m(P)(o.value?.pontosAtual||0,{withUnit:!0})),1)]),t("div",null,[a[15]||(a[15]=t("dt",null,"Projeção",-1)),t("dd",null,l(m(P)(o.value?.pontosProj||0,{withUnit:!0})),1)]),t("div",null,[a[16]||(a[16]=t("dt",null,"Incremento",-1)),t("dd",Xa,l(K(o.value?.pontosDelta||0)),1)])]),t("p",Ya," Peso máximo: "+l(m(P)(o.value?.pontosMeta||o.value?.pontosProj||0,{withUnit:!0})),1)]),t("article",Za,[t("header",at,[t("span",tt,[F(j,{name:"target",size:24})]),a[17]||(a[17]=t("h5",null,"Atingimento",-1))]),t("dl",et,[t("div",null,[a[18]||(a[18]=t("dt",null,"Atual",-1)),t("dd",null,l((o.value?.atingAtual||0).toFixed(1))+"%",1)]),t("div",null,[a[19]||(a[19]=t("dt",null,"Projeção",-1)),t("dd",null,l((o.value?.atingProj||0).toFixed(1))+"%",1)]),t("div",null,[a[20]||(a[20]=t("dt",null,"Variação",-1)),t("dd",st,l(o.value?.atingDelta&&o.value.atingDelta>0?"+":"")+l((o.value?.atingDelta||0).toFixed(1))+" p.p. ",1)])]),t("p",it," Realizado projetado: "+l(m(p)(o.value?.metric||"valor",o.value?.novoReal||0)),1)])])):(r(),n("div",La,[y.value?(r(),n(c,{key:0},[u(" Carregando indicadores... ")],64)):b.value?(r(),n(c,{key:1},[u(l(b.value),1)],64)):h.value.length===0?(r(),n(c,{key:2},[u(" Nenhum indicador com meta em valor ou quantidade está disponível. ")],64)):(r(),n(c,{key:3},[u(" Selecione um indicador com meta em valor ou quantidade para liberar a simulação. ")],64))])),s.value&&o.value?(r(),n("div",lt,[t("p",null,[u(" Incremento informado: "+l(m(p)(o.value.metric,o.value.deltaValue))+" · Realizado atual: "+l(m(p)(o.value.metric,o.value.realizado))+" · Meta vigente: "+l(m(p)(o.value.metric,o.value.meta))+" ",1),o.value.pontosMeta?(r(),n(c,{key:0},[u(" · Peso do indicador: "+l(m(P)(o.value.pontosMeta,{withUnit:!0})),1)],64)):g("",!0),s.value.ultimaAtualizacao?(r(),n(c,{key:1},[u(" · Última atualização: "+l(s.value.ultimaAtualizacao),1)],64)):g("",!0)]),a[21]||(a[21]=t("p",{class:"sim-whatif__foot-note"}," Projeção linear baseada nos dados atuais. Resultados reais podem variar conforme regras específicas do indicador. ",-1))])):g("",!0)])],64))])])])]))}}),ht=ha(ot,[["__scopeId","data-v-15289626"]]);export{ht as default};
