import{a as S,A as E,_ as A}from"./index.BTfDv-kk.js";import{u as B}from"./useGlobalFilters.DVWt81fx.js";import{h as L}from"./formatUtils.SsKD9Isb.js";import{b as V,r as h,e as k,y as z,w as P,m as i,q as e,M as T,F as _,D as N,E as p,u as f,C as R,o as l,k as M}from"./vendor.Mb-DmQZ9.js";import"./pdf-vendor.BFzd3waL.js";import"./icons-vendor.vP8HAgRq.js";import"./vue-router.BEbJbLaE.js";import"./calendarioService.YABvM0Wu.js";async function U(o,t){const n={};o&&(o.segmento&&(n.segmento=o.segmento),o.diretoria&&(n.diretoria=o.diretoria),o.regional&&(n.regional=o.regional),o.agencia&&(n.agencia=o.agencia),o.gerenteGestao&&(n.gerenteGestao=o.gerenteGestao),o.gerente&&(n.gerente=o.gerente),o.dataInicio&&(n.dataInicio=o.dataInicio),o.dataFim&&(n.dataFim=o.dataFim)),t&&(n.nivel=t);const d=await S(E.RANKING,n);return d.success&&d.data?d.data:(console.error("Erro ao buscar ranking:",d.error),null)}const $={class:"ranking-wrapper"},j={class:"ranking-view"},q={key:0,class:"ranking-content"},K={class:"card card--ranking"},O={class:"ranking-table-wrapper"},Q={class:"rk-table"},H={key:0,class:"error-state"},J={key:1,class:"empty-state"},W={key:0},X={key:1},Y={key:2,class:"ranking-content"},Z={class:"card card--ranking"},ee={class:"rk-summary",id:"rk-summary"},ae={class:"rk-badges"},te={class:"rk-badge"},se={class:"rk-badge"},oe={class:"ranking-table-wrapper",id:"rk-table"},ne={class:"rk-table"},re={class:"pos-col"},ie={class:"unit-col rk-name"},le={class:"points-col"},de=V({__name:"Ranking",setup(o){const{filterState:t,period:n,filterTrigger:d}=B(),c=h([]),m=h(!1),g=h(null),u=a=>{if(!a)return;const s=a.trim();if(!s)return;const r=s.toLowerCase();if(!(r==="todos"||r==="todas"||r===""))return s},b=k(()=>{const a={},s=u(t.value.segmento),r=u(t.value.diretoria),v=u(t.value.gerencia),F=u(t.value.agencia),G=u(t.value.ggestao),C=u(t.value.gerente);return s&&(a.segmento=s),r&&(a.diretoria=r),v&&(a.regional=v),F&&(a.agencia=F),G&&(a.gerenteGestao=G),C&&(a.gerente=C),n.value?.start&&(a.dataInicio=n.value.start),n.value?.end&&(a.dataFim=n.value.end),a}),y=k(()=>t.value.gerente&&t.value.gerente.toLowerCase()!=="todos"?"gerente":t.value.ggestao&&t.value.ggestao.toLowerCase()!=="todos"?"gerenteGestao":t.value.agencia&&t.value.agencia.toLowerCase()!=="todas"?"agencia":t.value.gerencia&&t.value.gerencia.toLowerCase()!=="todas"?"gerencia":t.value.diretoria&&t.value.diretoria.toLowerCase()!=="todas"?"diretoria":t.value.segmento&&t.value.segmento.toLowerCase()!=="todos"?"segmento":"gerenteGestao"),I=k(()=>({segmento:"Segmento",diretoria:"Diretoria",gerencia:"Regional",agencia:"Agência",gerenteGestao:"Gerente de gestão",gerente:"Gerente"})[y.value]||"Gerente de gestão"),w=async()=>{m.value=!0,g.value=null;try{const a=await U(b.value,y.value);a?c.value=a:(g.value="Não foi possível carregar os dados de ranking",c.value=[])}catch(a){g.value=a instanceof Error?a.message:"Erro ao carregar ranking",c.value=[]}finally{m.value=!1}};z(()=>{w()}),P([t,d],()=>{Object.keys(b.value).length>0||(c.value=[],g.value=null),w()},{deep:!0});const x=k(()=>c.value),D=a=>a==null||isNaN(a)?"—":new Intl.NumberFormat("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a);return(a,s)=>(l(),i("div",$,[e("div",j,[m.value?(l(),i("div",q,[e("div",K,[s[2]||(s[2]=T('<header class="card__header rk-head" data-v-645a584d><div class="skeleton skeleton--title" style="height:24px;width:150px;margin-bottom:8px;" data-v-645a584d></div><div class="skeleton skeleton--subtitle" style="height:16px;width:300px;" data-v-645a584d></div></header><div class="rk-summary" data-v-645a584d><div class="rk-badges" data-v-645a584d><div class="skeleton skeleton--badge" style="height:32px;width:120px;border-radius:6px;" data-v-645a584d></div><div class="skeleton skeleton--badge" style="height:32px;width:140px;border-radius:6px;" data-v-645a584d></div><div class="skeleton skeleton--badge" style="height:32px;width:180px;border-radius:6px;" data-v-645a584d></div></div></div>',2)),e("div",O,[e("table",Q,[s[1]||(s[1]=e("thead",null,[e("tr",null,[e("th",{class:"pos-col"},"#"),e("th",{class:"unit-col"},"Unidade"),e("th",{class:"points-col"},"Pontos")])],-1)),e("tbody",null,[(l(),i(_,null,N(10,r=>e("tr",{key:r,class:"rk-row"},[...s[0]||(s[0]=[e("td",{class:"pos-col"},[e("div",{class:"skeleton skeleton--text",style:{height:"16px",width:"20px",margin:"0 auto"}})],-1),e("td",{class:"unit-col"},[e("div",{class:"skeleton skeleton--text",style:{height:"16px",width:"80%"}})],-1),e("td",{class:"points-col"},[e("div",{class:"skeleton skeleton--text",style:{height:"16px",width:"60px",margin:"0 auto"}})],-1)])])),64))])])])])])):(l(),i(_,{key:1},[g.value?(l(),i("div",H,[e("p",null,p(g.value),1)])):c.value.length===0?(l(),i("div",J,[f(t).ggestao?(l(),i("p",W," Sem dados de ranking disponíveis para o gerente de gestão selecionado. ")):(l(),i("p",X," Selecione um gerente de gestão nos filtros para visualizar o ranking. "))])):(l(),i("div",Y,[e("div",Z,[s[6]||(s[6]=e("header",{class:"card__header rk-head"},[e("div",{class:"title-subtitle"},[e("h3",null,"Rankings"),e("p",{class:"muted"},"Compare diferentes visões respeitando os filtros aplicados.")])],-1)),e("div",ee,[e("div",ae,[e("span",te,[s[3]||(s[3]=e("strong",null,"Nível de agrupamento:",-1)),R(" "+p(I.value),1)]),e("span",se,[s[4]||(s[4]=e("strong",null,"Quantidade de participantes:",-1)),R(" "+p(f(L)(x.value.length)),1)])])]),e("div",oe,[e("table",ne,[s[5]||(s[5]=e("thead",null,[e("tr",null,[e("th",{class:"pos-col"},"#"),e("th",{class:"unit-col"},"Unidade"),e("th",{class:"points-col"},"Pontos")])],-1)),e("tbody",null,[(l(!0),i(_,null,N(x.value,(r,v)=>(l(),i("tr",{key:`${r.unidade}-${v}`,class:M(["rk-row",{"rk-row--top":v===0}])},[e("td",re,p(f(L)(r.position??v+1)),1),e("td",ie,p(r.displayLabel??r.label??"—"),1),e("td",le,p(D(r.pontos)),1)],2))),128))])])])])]))],64))])]))}}),_e=A(de,[["__scopeId","data-v-645a584d"]]);export{_e as default};
