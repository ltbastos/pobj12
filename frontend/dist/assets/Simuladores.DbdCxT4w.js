import{b as la,r as x,y as oa,e as b,w as na,m as r,q as t,M as ra,F as h,B as da,t as A,k as $,G as ua,E as l,H as ca,j as g,C as c,u,D as ma,g as O,o as n}from"./vendor.iNPlSTaR.js";import{a as va,A as ha,I as B,_ as fa}from"./index.gUBC-8sV.js";import{e as _,E as _a,f as D,a as P}from"./EmptyState.vue_vue_type_style_index_0_scoped_69c25b95_lang.Cl86qzRi.js";import{S as pa}from"./SelectInput.E1qTZuex.js";import{E as wa}from"./EmptyState.DY75w1u5.js";import"./pdf-vendor.jXUlHPMi.js";import"./icons-vendor.pg7b-e9c.js";import"./vue-router.BQVFLPdy.js";async function ga(T){const p={},d=await va(ha.SIMULADOR,p);return d.success&&d.data?d.data:(console.error("Erro ao buscar produtos para simulador:",d.error),null)}const ka={class:"simuladores-wrapper"},ba={class:"simuladores-view"},ya={class:"card card--simuladores"},Ma={id:"sim-whatif",class:"sim-whatif"},xa={key:0,class:"sim-whatif__skeleton"},Da={class:"sim-whatif__field"},Pa={class:"sim-whatif__field"},Ra={id:"sim-whatif-prefix",class:"sim-whatif__prefix"},Ia=["placeholder","disabled"],Sa={class:"sim-whatif__hint-group"},Aa={id:"sim-whatif-unit",class:"sim-whatif__hint"},Fa={class:"sim-whatif__hint-item"},za={class:"sim-whatif__hint-item"},Ba={key:0,class:"sim-whatif__hint-item sim-whatif__hint-item--gap"},Na={key:0,class:"sim-whatif__hint sim-whatif__hint--delta"},ja={key:0,class:"sim-quick__label"},Ea={key:1,class:"sim-quick__chips"},Ca=["title","onClick"],Va={class:"sim-whatif__results"},La={class:"sim-whatif__header"},Ua={id:"sim-whatif-title"},qa={id:"sim-whatif-subtitle",class:"muted"},$a={key:0,class:"sim-whatif__empty-wrapper"},Oa={key:0,class:"sim-whatif__empty"},Ta={key:3,class:"sim-whatif__empty"},Ga={key:1,id:"sim-whatif-cards",class:"sim-whatif-cards"},Ha={class:"sim-whatif-card sim-whatif-card--var"},Ja={class:"sim-whatif-card__head"},Ka={class:"sim-whatif-card__icon"},Qa={class:"sim-whatif-card__stats"},Wa={class:"sim-whatif-card__highlight"},Xa={class:"sim-whatif-card__meta"},Ya={class:"sim-whatif-card sim-whatif-card--points"},Za={class:"sim-whatif-card__head"},at={class:"sim-whatif-card__icon"},tt={class:"sim-whatif-card__stats"},et={class:"sim-whatif-card__highlight"},st={class:"sim-whatif-card__meta"},it={class:"sim-whatif-card sim-whatif-card--hit"},lt={class:"sim-whatif-card__head"},ot={class:"sim-whatif-card__icon"},nt={class:"sim-whatif-card__stats"},rt={class:"sim-whatif-card__highlight"},dt={class:"sim-whatif-card__meta"},ut={key:2,id:"sim-whatif-foot",class:"sim-whatif__foot"},ct=la({__name:"Simuladores",setup(T){const p=x(""),d=x(0),y=x(!1),M=x(null),v=x([]),G=async()=>{y.value=!0,M.value=null;try{const e=await ga();e?(v.value=e,v.value.length>0&&!p.value&&(p.value=v.value[0]?.id||"")):(M.value="Erro ao carregar produtos",v.value=[])}catch(e){M.value=e instanceof Error?e.message:"Erro desconhecido",console.error("Erro ao carregar produtos:",e),v.value=[]}finally{y.value=!1}};oa(()=>{G()});const s=b(()=>v.value.find(e=>e.id===p.value)||null);b(()=>{const e=new Map;return v.value.forEach(a=>{const i=a.sectionId||a.sectionLabel||"__";e.has(i)||e.set(i,[]),e.get(i).push(a)}),Array.from(e.entries()).map(([a,i])=>({sectionId:a,sectionLabel:i[0]?.sectionLabel||a,items:i.sort((m,w)=>m.label.localeCompare(w.label,"pt-BR"))}))});const H=b(()=>v.value.map(e=>({id:e.id,nome:`${e.sectionLabel} - ${e.label}`})).sort((e,a)=>e.nome.localeCompare(a.nome,"pt-BR"))),J=e=>{p.value=e},f=e=>{if(e==null||e==="")return 0;const a=typeof e=="string"?parseFloat(e):e;return Number.isFinite(a)?a:0},o=b(()=>{if(!s.value)return null;const e=s.value,a=e.metric||"valor",i=Math.max(0,f(e.meta)),m=Math.max(0,f(e.realizado)),w=Math.max(0,f(e.variavelMeta||0)),I=Math.max(0,f(e.variavelReal||0)),k=Math.max(0,f(e.pontosMeta)),aa=Math.max(0,f(e.pontosBrutos)),F=Math.max(0,Math.min(k||aa,f(e.pontos))),S=Math.max(0,f(d.value)),z=m+S,ta=i>0?(w||I)/i:0,j=i>0?k/i:0,E=I+S*ta,C=w>0?Math.min(w,E):E,ea=Math.max(0,C-I),V=k>0?j*z:F+S*j,L=k>0?Math.max(0,Math.min(k,V)):Math.max(0,V),sa=Math.max(0,L-F),U=i>0?m/i*100:0,q=i>0?z/i*100:0,ia=Math.max(0,q-U);return{metric:a,meta:i,realizado:m,novoReal:z,deltaValue:S,variavelAtual:I,variavelProj:C,variavelDelta:ea,pontosAtual:F,pontosProj:L,pontosDelta:sa,atingAtual:U,atingProj:q,atingDelta:ia,variavelMeta:w,pontosMeta:k}}),R=b(()=>{if(!s.value)return[];const e=s.value,a=Math.max(0,f(e.meta));if(!(a>0))return[];const i=Math.max(0,a-f(e.realizado));return[{label:"+5% da meta",value:a*.05},{label:"+10% da meta",value:a*.1},{label:i>0?"Fechar a meta":"+25% da meta",value:i>0?i:a*.25}]}),K=e=>{const a=D(e);return e>0?`+${a}`:a},Q=e=>{const a=P(e,{withUnit:!0});return e>0?`+${a}`:a},W=e=>{const a=s.value;if(!a)return;const i=a.metric==="valor"?1e3:1,m=Math.max(0,Math.round(e/i)*i);d.value=m},X=()=>{if(d.value>0&&s.value){const e=s.value.metric==="valor"?1e3:1;d.value=Math.round(d.value/e)*e}},Y=e=>{e.target.select()};na(p,()=>{d.value=0});const N=b({get:()=>!d.value||d.value===0?"":new Intl.NumberFormat("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(d.value),set:e=>{let a=e.replace(/[^\d,.]/g,"");if(a.includes(","))a=a.replace(/\./g,"").replace(",","");else if(a.includes(".")){const m=a.split(".");m.length===2&&m[1]?.length&&m[1]?.length<=2?a=a.replace(".",""):a=a.replace(/\./g,"")}const i=a?parseFloat(a):0;d.value=isNaN(i)?0:Math.max(0,Math.round(i))}}),Z=e=>!e||e===0?"0":s.value?.metric==="valor"?D(e):new Intl.NumberFormat("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)+" un";return(e,a)=>(n(),r("div",ka,[t("div",ba,[t("section",ya,[a[22]||(a[22]=t("header",{class:"card__header"},[t("div",{class:"title-subtitle"},[t("h3",null,'Simulador "E se?"'),t("p",{class:"muted"},"Simule o impacto de incrementos em indicadores específicos.")])],-1)),t("div",Ma,[y.value?(n(),r("div",xa,[...a[2]||(a[2]=[ra('<div class="sim-whatif__form" data-v-1b1af6c0><div class="sim-whatif__field" data-v-1b1af6c0><div class="skeleton skeleton--label" data-v-1b1af6c0></div><div class="skeleton skeleton--input" data-v-1b1af6c0></div></div><div class="sim-whatif__field" data-v-1b1af6c0><div class="skeleton skeleton--label" data-v-1b1af6c0></div><div class="skeleton skeleton--input" data-v-1b1af6c0></div><div class="skeleton skeleton--hint" data-v-1b1af6c0></div></div></div><div class="skeleton skeleton--shortcuts" data-v-1b1af6c0></div><div class="sim-whatif__results" data-v-1b1af6c0><div class="skeleton skeleton--title" data-v-1b1af6c0></div><div class="skeleton skeleton--subtitle" data-v-1b1af6c0></div><div class="sim-whatif-cards" data-v-1b1af6c0><div class="skeleton skeleton--card" data-v-1b1af6c0></div><div class="skeleton skeleton--card" data-v-1b1af6c0></div><div class="skeleton skeleton--card" data-v-1b1af6c0></div></div></div>',3)])])):(n(),r(h,{key:1},[t("form",{id:"sim-whatif-form",class:"sim-whatif__form",onSubmit:a[1]||(a[1]=da(()=>{},["prevent"]))},[t("div",Da,[a[3]||(a[3]=t("label",{for:"sim-whatif-indicador",class:"muted"},"INDICADOR",-1)),A(pa,{id:"sim-whatif-indicador","model-value":p.value,options:H.value,placeholder:"Selecione um indicador",label:"Indicador",disabled:v.value.length===0||y.value,"onUpdate:modelValue":J},null,8,["model-value","options","disabled"])]),t("div",Pa,[a[8]||(a[8]=t("label",{for:"sim-whatif-extra",class:"muted"},"INCREMENTO",-1)),t("div",{class:$(["sim-whatif__input-group",{"has-value":d.value>0}])},[t("span",Ra,l(s.value?.metric==="valor"?"R$":"+"),1),ua(t("input",{id:"sim-whatif-extra",type:"text","onUpdate:modelValue":a[0]||(a[0]=i=>N.value=i),inputmode:"numeric",class:"input sim-whatif__input",placeholder:s.value?.metric==="valor"?"0,00":"0",disabled:!s.value,onBlur:X,onFocus:Y},null,40,Ia),[[ca,N.value]])],2),t("div",Sa,[t("p",Aa,[s.value?(n(),r(h,{key:0},[t("span",Fa,[a[4]||(a[4]=t("strong",null,"Meta:",-1)),c(" "+l(u(_)(s.value.metric,s.value.meta)),1)]),t("span",za,[a[5]||(a[5]=t("strong",null,"Realizado:",-1)),c(" "+l(u(_)(s.value.metric,s.value.realizado)),1)]),s.value.meta>s.value.realizado?(n(),r("span",Ba,[a[6]||(a[6]=t("strong",null,"Falta:",-1)),c(" "+l(u(_)(s.value.metric,s.value.meta-s.value.realizado)),1)])):g("",!0)],64)):(n(),r(h,{key:1},[c(" Selecione um indicador elegível. ")],64))]),d.value>0&&s.value?(n(),r("p",Na,[a[7]||(a[7]=c(" Incremento: ",-1)),t("strong",null,l(Z(d.value)),1)])):g("",!0)])])],32),t("div",{id:"sim-whatif-shortcuts",class:$(["sim-quick",{"is-empty":!s.value||R.value.length===0}])},[s.value&&R.value.length>0?(n(),r("span",ja,"Atalhos")):g("",!0),s.value&&R.value.length>0?(n(),r("div",Ea,[(n(!0),r(h,null,ma(R.value,(i,m)=>(n(),r("button",{key:m,type:"button",class:"sim-chip",title:u(_)(s.value.metric,i.value),onClick:w=>W(i.value)},l(i.label),9,Ca))),128))])):g("",!0)],2),t("div",Va,[t("div",La,[t("h4",Ua,[s.value?(n(),r(h,{key:0},[c(" Impacto em "+l(s.value.label),1)],64)):v.value.length===0?(n(),r(h,{key:1},[c(" Sem indicadores elegíveis ")],64)):(n(),r(h,{key:2},[c(" Escolha um indicador para iniciar ")],64))]),t("p",qa,[s.value?(n(),r(h,{key:0},[c(l(s.value.sectionLabel)+" · Meta de "+l(u(_)(s.value.metric,s.value.meta)),1)],64)):v.value.length===0?(n(),r(h,{key:1},[c(" Nenhum indicador disponível no momento. ")],64)):(n(),r(h,{key:2},[c(" Selecione um indicador e informe um incremento para ver o impacto. ")],64))])]),s.value?(n(),r("div",Ga,[t("article",Ha,[t("header",Ja,[t("span",Ka,[A(B,{name:"coin",size:24})]),a[9]||(a[9]=t("h5",null,"Remuneração variável",-1))]),t("dl",Qa,[t("div",null,[a[10]||(a[10]=t("dt",null,"Atual",-1)),t("dd",null,l(u(D)(o.value?.variavelAtual||0)),1)]),t("div",null,[a[11]||(a[11]=t("dt",null,"Projeção",-1)),t("dd",null,l(u(D)(o.value?.variavelProj||0)),1)]),t("div",null,[a[12]||(a[12]=t("dt",null,"Incremento",-1)),t("dd",Wa,l(K(o.value?.variavelDelta||0)),1)])]),t("p",Xa," Meta de remuneração: "+l(u(D)(o.value?.variavelMeta||o.value?.variavelProj||0)),1)]),t("article",Ya,[t("header",Za,[t("span",at,[A(B,{name:"medal",size:24})]),a[13]||(a[13]=t("h5",null,"Pontuação",-1))]),t("dl",tt,[t("div",null,[a[14]||(a[14]=t("dt",null,"Atual",-1)),t("dd",null,l(u(P)(o.value?.pontosAtual||0,{withUnit:!0})),1)]),t("div",null,[a[15]||(a[15]=t("dt",null,"Projeção",-1)),t("dd",null,l(u(P)(o.value?.pontosProj||0,{withUnit:!0})),1)]),t("div",null,[a[16]||(a[16]=t("dt",null,"Incremento",-1)),t("dd",et,l(Q(o.value?.pontosDelta||0)),1)])]),t("p",st," Peso máximo: "+l(u(P)(o.value?.pontosMeta||o.value?.pontosProj||0,{withUnit:!0})),1)]),t("article",it,[t("header",lt,[t("span",ot,[A(B,{name:"target",size:24})]),a[17]||(a[17]=t("h5",null,"Atingimento",-1))]),t("dl",nt,[t("div",null,[a[18]||(a[18]=t("dt",null,"Atual",-1)),t("dd",null,l((o.value?.atingAtual||0).toFixed(1))+"%",1)]),t("div",null,[a[19]||(a[19]=t("dt",null,"Projeção",-1)),t("dd",null,l((o.value?.atingProj||0).toFixed(1))+"%",1)]),t("div",null,[a[20]||(a[20]=t("dt",null,"Variação",-1)),t("dd",rt,l(o.value?.atingDelta&&o.value.atingDelta>0?"+":"")+l((o.value?.atingDelta||0).toFixed(1))+" p.p. ",1)])]),t("p",dt," Realizado projetado: "+l(u(_)(o.value?.metric||"valor",o.value?.novoReal||0)),1)])])):(n(),r("div",$a,[y.value?(n(),r("div",Oa," Carregando indicadores... ")):M.value?(n(),O(_a,{key:1,message:M.value},null,8,["message"])):v.value.length===0?(n(),O(wa,{key:2,title:"Nenhum indicador disponível",message:"Nenhum indicador com meta em valor ou quantidade está disponível."})):(n(),r("div",Ta," Selecione um indicador com meta em valor ou quantidade para liberar a simulação. "))])),s.value&&o.value?(n(),r("div",ut,[t("p",null,[c(" Incremento informado: "+l(u(_)(o.value.metric,o.value.deltaValue))+" · Realizado atual: "+l(u(_)(o.value.metric,o.value.realizado))+" · Meta vigente: "+l(u(_)(o.value.metric,o.value.meta))+" ",1),o.value.pontosMeta?(n(),r(h,{key:0},[c(" · Peso do indicador: "+l(u(P)(o.value.pontosMeta,{withUnit:!0})),1)],64)):g("",!0),s.value.ultimaAtualizacao?(n(),r(h,{key:1},[c(" · Última atualização: "+l(s.value.ultimaAtualizacao),1)],64)):g("",!0)]),a[21]||(a[21]=t("p",{class:"sim-whatif__foot-note"}," Projeção linear baseada nos dados atuais. Resultados reais podem variar conforme regras específicas do indicador. ",-1))])):g("",!0)])],64))])])])]))}}),kt=fa(ct,[["__scopeId","data-v-1b1af6c0"]]);export{kt as default};
